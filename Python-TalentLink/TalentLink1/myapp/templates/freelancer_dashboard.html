{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Freelancer Dashboard</title>
    <style>
        body { 
            background: #0f172a; 
            font-family: "Segoe UI"; 
            color: #e5e7eb; 
            margin:0; 
            padding:20px;
        }

        .header { 
            display:flex; 
            justify-content:space-between; 
            align-items:center; 
            margin-bottom:20px; 
        }

        h1 { margin:0; }

        .logout-btn { 
            background:#ef4444; 
            color:#020617; 
            padding:8px 16px; 
            border-radius:10px; 
            text-decoration:none; 
            font-weight:bold; 
        }

        /* ===== SEARCH BAR ===== */
        .search-box {
            margin-bottom: 25px;
            display: flex;
            gap: 10px;
        }

        .search-box input {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            border: none;
            font-size: 14px;
        }

        .search-box button {
            padding: 10px 18px;
            border-radius: 10px;
            border: none;
            background: #38bdf8;
            color: #020617;
            font-weight: bold;
            cursor: pointer;
        }

        .project-card { 
            background:#1e293b; 
            padding:20px; 
            border-radius:14px; 
            margin-bottom:20px; 
        }

        .label { font-size:13px; color:#94a3b8; margin-top:10px; }
        .value { font-size:15px; font-weight:500; margin-top:3px; }

        .btn { 
            display:inline-block; 
            padding:8px 16px; 
            margin-top:10px; 
            margin-right:10px; 
            border-radius:10px; 
            font-weight:bold; 
            text-decoration:none; 
        }

        .blue { background:#38bdf8; color:#020617; }
        .green { background:#22c55e; color:#020617; }

        .contracts-table { 
            width:100%; 
            border-collapse: collapse; 
            margin-top:30px; 
        }

        .contracts-table th, 
        .contracts-table td { 
            padding:12px 10px; 
            border-bottom:1px solid #334155; 
            text-align:left; 
        }

        .contracts-table th { color:#94a3b8; }

        .contracts-table td a { 
            background:#22c55e; 
            color:#022c22; 
            padding:6px 12px; 
            border-radius:8px; 
            text-decoration:none; 
            font-size:13px; 
            font-weight:bold; 
        }
    </style>
</head>

<body>

    <div class="header">
        <h1>Freelancer Dashboard</h1>
        <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
    </div>

    <!-- ===== SEARCH BAR ===== -->
    <form method="get" class="search-box">
        <input 
            type="text" 
            name="q" 
            placeholder="Search projects by title, description, or client..."
            value="{{ request.GET.q }}"
        >
        <button type="submit">Search</button>
    </form>

    {% for project in projects %}
    <div class="project-card">
        <div class="label">Project</div>
        <div class="value">{{ project.title }}</div>

        <div class="label">Description</div>
        <div class="value">{{ project.description }}</div>

        <div class="label">Client</div>
        <div class="value">{{ project.client.username }}</div>

        <a href="{% url 'project_detail' project.id %}" class="btn blue">View Details</a>
        <a href="{% url 'submit_proposal' project.id %}" class="btn green">Submit Proposal</a>
    </div>
    {% empty %}
        <p>No projects found.</p>
    {% endfor %}

    <h3>Your Contracts</h3>

    {% if contracts %}
    <table class="contracts-table">
        <tr>
            <th>Project</th>
            <th>Client</th>
            <th>Status</th>
            <th>Chat</th>
        </tr>
        {% for contract in contracts %}
        <tr>
            <td>{{ contract.project.title }}</td>
            <td>{{ contract.client.user.username }}</td>
            <td>{{ contract.status }}</td>
            <td>
                <a href="{% url 'contract_chat' contract.id %}">Chat</a>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% else %}
        <p>No contracts yet.</p>
    {% endif %}

</body>
</html>
